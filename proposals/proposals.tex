\documentclass[11pt,a4paper]{scrartcl}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
\usepackage{geometry}
\usepackage{enumitem}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{ragged2e}
\usepackage{fancyhdr}
\usepackage{amssymb}
\usepackage{tikz}
\usepackage{framed}
\usepackage{mdframed}
\geometry{a4paper, margin=2.5cm}
\setlength{\emergencystretch}{3em}

\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\small CAPRA --- Report Design Proposals}
\fancyhead[R]{\small February 25, 2026}
\fancyfoot[C]{\thepage}

% Severity badges (text-based, no color)
\newcommand{\badgehigh}{\fbox{\textsc{high}}}
\newcommand{\badgemed}{\fbox{\textsc{medium}}}
\newcommand{\badgelow}{\fbox{\textsc{low}}}
\newcommand{\ok}{$\checkmark$}
\newcommand{\nok}{$\times$}

% Proposal framing
\mdfdefinestyle{proposalframe}{%
    linewidth=0.8pt,
    innerleftmargin=10pt,
    innerrightmargin=10pt,
    innertopmargin=8pt,
    innerbottommargin=8pt,
    roundcorner=3pt
}

\title{CAPRA Report --- Design Proposals\\[0.3em]\large Visual comparison of section layouts}
\author{Automated Proposal Generator}
\date{February 25, 2026}

\begin{document}
\maketitle
\tableofcontents
\newpage

% ══════════════════════════════════════════════════════════════
\section{Summary}
% ══════════════════════════════════════════════════════════════

\subsection{Proposal A --- Document Overview only (clean text)}
\begin{mdframed}[style=proposalframe]
\section*{Summary}

This document presents a software engineering project for a \textbf{library management system} designed to handle book cataloging, user registration, and loan operations. The system is architected using a layered approach with service, persistence, and UI components, implemented in Java with a relational database backend. The project demonstrates a structured approach to requirements analysis, system design, and testing, with comprehensive use-case modeling and architectural documentation.
\end{mdframed}

\subsection{Proposal B --- Document Overview + inline stats}
\begin{mdframed}[style=proposalframe]
\section*{Summary}

This document presents a software engineering project for a \textbf{library management system} designed to handle book cataloging, user registration, and loan operations. The system is architected using a layered approach with service, persistence, and UI components, implemented in Java with a relational database backend. The project demonstrates a structured approach to requirements analysis, system design, and testing, with comprehensive use-case modeling and architectural documentation.

\medskip
\noindent\rule{\textwidth}{0.4pt}\\
{\small Issues found: \textbf{6} (HIGH: 0, MEDIUM: 6, LOW: 0) \quad---\quad Features: 5/7 present}
\end{mdframed}

\subsection{Proposal C --- Metrics box + Document Overview}
\begin{mdframed}[style=proposalframe]
\section*{Summary}

\noindent\fbox{\parbox{\dimexpr\textwidth-2\fboxsep-2\fboxrule}{%
\centering\textbf{Audit Overview} \\[0.3em]
Total issues: \textbf{6} \quad---\quad HIGH: \textbf{0} \quad MEDIUM: \textbf{6} \quad LOW: \textbf{0}
\\[0.2em] Features: 5 present / 2 partial / 0 absent \quad (avg.\ coverage: \textbf{84\%})
}}
\vspace{0.6em}

This document presents a software engineering project for a \textbf{library management system} designed to handle book cataloging, user registration, and loan operations. The system is architected using a layered approach with service, persistence, and UI components, implemented in Java with a relational database backend.
\end{mdframed}

\newpage
% ══════════════════════════════════════════════════════════════
\section{Architecture Analysis (new section)}
% ══════════════════════════════════════════════════════════════

\subsection{Proposal A --- LLM description + description list}
\begin{mdframed}[style=proposalframe]
\section*{Architecture Analysis}

The system follows a \textbf{layered architecture} with three main tiers: a JavaFX-based presentation layer (controllers), a service layer (business logic), and a DAO-based persistence layer backed by MySQL. Session management uses a singleton pattern via \texttt{Sessione} class. The architecture employs MVC for the UI and DAO pattern for data access.

\begin{description}[style=nextline, leftmargin=1em]
  \item[ARCH-001 --- \badgemed]
  \textbf{Problem:} Service layer partially mixes business logic with UI concerns. Some service methods reference JavaFX alert dialogs directly, breaking separation of concerns.

  \textbf{Suggestion:} Move all alert/dialog logic to the controller layer. Service methods should return result objects or throw exceptions; controllers translate those into UI feedback.

  \item[ARCH-002 --- \badgemed]
  \textbf{Problem:} Session management via singleton contradicts stated support for concurrent user access. The \texttt{Sessione} class holds a single user reference, making multi-session scenarios impossible.

  \textbf{Suggestion:} Either clarify that the system is single-user (desktop app) and remove the concurrent access claim, or redesign session management to support multiple sessions (e.g., session tokens).
\end{description}
\end{mdframed}

\subsection{Proposal B --- LLM description + itemize compact}
\begin{mdframed}[style=proposalframe]
\section*{Architecture Analysis}

The system follows a \textbf{layered architecture} with three main tiers: a JavaFX-based presentation layer (controllers), a service layer (business logic), and a DAO-based persistence layer backed by MySQL. Session management uses a singleton pattern via \texttt{Sessione} class.

\begin{itemize}[leftmargin=*]
  \item \textbf{ARCH-001} [\badgemed] --- Service layer partially mixes business logic with UI concerns. Some service methods reference JavaFX alert dialogs directly.

  \textbf{Suggestion:} Move all alert/dialog logic to the controller layer.

  \item \textbf{ARCH-002} [\badgemed] --- Session management via singleton contradicts stated concurrent access support.

  \textbf{Suggestion:} Clarify single-user scope or redesign session management.
\end{itemize}
\end{mdframed}

\subsection{Proposal C --- LLM description + compact table + details}
\begin{mdframed}[style=proposalframe]
\section*{Architecture Analysis}

The system follows a \textbf{layered architecture} with three main tiers: a JavaFX-based presentation layer, a service layer, and a DAO-based persistence layer backed by MySQL.

\medskip
\begin{tabular}{l c >{\RaggedRight\arraybackslash}p{8cm}}
\toprule
\textbf{ID} & \textbf{Severity} & \textbf{Problem} \\
\midrule
ARCH-001 & \badgemed & Service layer mixes logic with UI concerns \\
ARCH-002 & \badgemed & Session mgmt contradicts concurrency claim \\
\bottomrule
\end{tabular}

\medskip
\paragraph{ARCH-001} Some service methods reference JavaFX alert dialogs directly, breaking separation of concerns. \textbf{Suggestion:} Move dialog logic to controllers; services should return results or throw exceptions.

\paragraph{ARCH-002} The \texttt{Sessione} singleton holds a single user reference, making concurrent sessions impossible. \textbf{Suggestion:} Clarify single-user scope or redesign with session tokens.
\end{mdframed}

\newpage
% ══════════════════════════════════════════════════════════════
\section{Use Case Analysis}
% ══════════════════════════════════════════════════════════════

\subsection{Proposal A --- Only UCs with problems, others listed at end}
\begin{mdframed}[style=proposalframe]
\section*{Use Case Analysis}
The document describes \textbf{17 use cases}, of which 4 have structured templates. 2 use cases present issues requiring attention.

\paragraph{UC-2 --- Effettua prestito}
\textbf{Problem:} Business rule on max 3 concurrent loans not reflected in use case template. The alternative course does not describe what happens when the limit is exceeded.\\
\textbf{Suggestion:} Update UC-2 to explicitly state the 3-loan limit and describe the rejection flow in the alternative course.

\paragraph{UC-3 --- Aggiunge libro}
\textbf{Problem:} Actor ``Bibliotecario'' inconsistent with ``Biblioteca'' used in UC diagram. This creates ambiguity about who performs the operation.\\
\textbf{Suggestion:} Unify actor naming across all diagrams, templates, and controller references.

\medskip
\noindent\rule{\textwidth}{0.4pt}\\
{\small \textbf{Use cases without issues:} UC-1, UC-4, UC-5, UC-6, UC-7, UC-8, UC-9, UC-10, UC-11, UC-12, UC-13, UC-14, UC-15, UC-16, UC-17}
\end{mdframed}

\subsection{Proposal B --- Split with/without template, problems inline}
\begin{mdframed}[style=proposalframe]
\section*{Use Case Analysis}
The document describes \textbf{17 use cases}.

\subsection*{Use Cases with Structured Template}

\paragraph{UC-1 --- Registrazione} \ok\ No issues identified.

\paragraph{UC-2 --- Effettua prestito}
\begin{description}[style=nextline, leftmargin=1em, font=\normalfont]
  \item[\badgemed\ Max loan constraint missing]
  \textbf{Problem:} The alternative course does not describe the 3-loan limit enforcement.\\
  \textbf{Suggestion:} Add the constraint and rejection flow to the alternative course.
\end{description}

\paragraph{UC-3 --- Aggiunge libro}
\begin{description}[style=nextline, leftmargin=1em, font=\normalfont]
  \item[\badgemed\ Actor naming inconsistency]
  \textbf{Problem:} ``Bibliotecario'' vs ``Biblioteca'' across diagrams and text.\\
  \textbf{Suggestion:} Unify actor naming throughout the document.
\end{description}

\paragraph{UC-4 --- Conclude Prestito} \ok\ No issues identified.

\subsection*{Use Cases without Structured Template}
UC-5 through UC-17 are referenced in the use-case diagram but lack a formal template. No additional issues were identified beyond the absence of structured descriptions.
\end{mdframed}

\subsection{Proposal C --- Only UCs with problems, compact list at end}
\begin{mdframed}[style=proposalframe]
\section*{Use Case Analysis}
The document describes \textbf{17 use cases} (4 with structured template).

\medskip
\noindent\textbf{UC-2 --- Effettua prestito}\\
$\triangleright$ Business rule on max loans not in template\\
$\rightarrow$ Add constraint to alternative course

\medskip
\noindent\textbf{UC-3 --- Aggiunge libro}\\
$\triangleright$ Actor inconsistency: ``Bibliotecario'' vs ``Biblioteca''\\
$\rightarrow$ Unify actor naming across diagrams and templates

\medskip
\noindent\rule{\textwidth}{0.4pt}\\
{\small The remaining 15 use cases do not present significant issues: UC-1, UC-4, UC-5, UC-6, UC-7, UC-8, UC-9, UC-10, UC-11, UC-12, UC-13, UC-14, UC-15, UC-16, UC-17}
\end{mdframed}

\newpage
% ══════════════════════════════════════════════════════════════
\section{Testing Analysis}
% ══════════════════════════════════════════════════════════════

\subsection{Proposal A --- Strategy description + list of uncovered UCs}
\begin{mdframed}[style=proposalframe]
\section*{Testing Analysis}

\subsection*{Testing Strategy}
The project uses \textbf{JUnit} for unit tests and \textbf{TestFX} for UI tests. Unit tests cover core business operations (loan reservations, cancellations, ISBN retrieval, availability checks). UI tests verify login flows, field validation, and book reservation interactions. Error scenarios include invalid logins, field validation failures, unavailable books, and exceeded loan limits.

\subsection*{Missing Test Coverage}
The following use cases lack explicit test coverage:
\begin{itemize}[nosep]
  \item UC-3 --- Aggiunge libro: no unit or UI test for adding books
  \item UC-4 --- Conclude Prestito: no test for loan conclusion
  \item UC-6 --- Modifica account: no test for profile update
  \item UC-7 --- Elimina account: no test for account deletion
  \item UC-8 --- Visualizza catalogo: browsing/search not tested
  \item UC-13 --- Effettua commento su opera: comment creation untested
  \item UC-14 --- Effettua commento su volume: volume comments untested
  \item UC-15 --- Visualizza commenti: comment listing untested
  \item UC-16 --- Modifica libro: book editing untested
  \item UC-17 --- Rimuove libro: book removal untested
\end{itemize}

\medskip
\textbf{Suggestion:} Add at least one test per uncovered UC, starting from the most critical business operations (UC-3, UC-4).
\end{mdframed}

\subsection{Proposal B --- Strategy + compact mapping table}
\begin{mdframed}[style=proposalframe]
\section*{Testing Analysis}

\subsection*{Testing Strategy}
The project uses \textbf{JUnit} for unit tests and \textbf{TestFX} for UI tests. Coverage focuses on loan management operations and user registration/login.

\subsection*{Test Coverage Map}
\begin{longtable}{l >{\RaggedRight\arraybackslash}p{4cm} c >{\RaggedRight\arraybackslash}p{5cm}}
\toprule
\textbf{UC} & \textbf{Name} & \textbf{Test} & \textbf{Test Methods} \\
\midrule
\endhead
UC-1 & Registrazione & \ok & testEmailNonValidaMostraErrore \\
UC-2 & Effettua prestito & \ok & testPrenotaEAnnullaPrestito \\
UC-3 & Aggiunge libro & \nok & --- \\
UC-4 & Conclude Prestito & \nok & --- \\
UC-5 & Login & \ok & testLoginInvalido, testLoginValido \\
UC-6 & Modifica account & \nok & --- \\
UC-7 & Elimina account & \nok & --- \\
\multicolumn{4}{c}{\textit{[...remaining UCs...]}} \\
\bottomrule
\end{longtable}

\textbf{Suggestion:} Prioritize tests for UC-3 and UC-4 (core library operations).
\end{mdframed}

\subsection{Proposal C --- Strategy + single grouped issue}
\begin{mdframed}[style=proposalframe]
\section*{Testing Analysis}

\subsection*{Testing Strategy}
The project uses \textbf{JUnit} for unit tests and \textbf{TestFX} for UI tests. Unit tests verify core business operations. UI tests cover login and registration validation.

\subsection*{Test Issues}
\begin{description}[style=nextline, leftmargin=1em]
  \item[TST-001 --- \badgemed\ --- 10 use cases lack test coverage]
  \textbf{Problem:} The document describes tests only for UC-1, UC-2, UC-5, UC-9, UC-10, UC-11, UC-12. The remaining 10 use cases (UC-3, UC-4, UC-6, UC-7, UC-8, UC-13, UC-14, UC-15, UC-16, UC-17) have no associated test cases.

  \textbf{Suggestion:} Create a traceability table mapping each UC to its tests. Implement at least one test per critical use case, prioritizing UC-3 (Aggiunge libro) and UC-4 (Conclude Prestito).
\end{description}
\end{mdframed}

\newpage
% ══════════════════════════════════════════════════════════════
\section{Traceability Analysis}
% ══════════════════════════════════════════════════════════════

\subsection{Proposal A --- Description list with status + problem/suggestion}
\begin{mdframed}[style=proposalframe]
\section*{Traceability Analysis}
This section analyzes traceability between use cases, their design implementation, and test coverage.\\
Of \textbf{17} traced use cases: 7 fully covered, 10 with gaps.

\subsection*{Traceability Gaps}

\begin{description}[style=nextline, leftmargin=1em]
  \item[UC-3 --- Aggiunge libro]
  Design: \ok\ \quad Test: \nok

  \textbf{Gap:} No unit or UI tests documented for adding a new book to the catalog.\\
  \textbf{Suggestion:} Add a JUnit test for \texttt{LibroService.aggiungiLibro()} verifying the complete book addition flow.

  \item[UC-4 --- Conclude Prestito]
  Design: \ok\ \quad Test: \nok

  \textbf{Gap:} No explicit test for loan conclusion.\\
  \textbf{Suggestion:} Add a test verifying \texttt{PrestitoService} loan completion and status update.

  \item[UC-6 --- Modifica account]
  Design: \ok\ \quad Test: \nok

  \textbf{Gap:} No tests for profile update via \texttt{ProfiloController}.\\
  \textbf{Suggestion:} Add unit test for \texttt{UtenteService.modificaUtente()}.

  \item[\textit{[...remaining 7 gaps follow same pattern...]}]
\end{description}

\subsection*{Fully Traced Use Cases}
The following use cases have complete traceability (design + test coverage):
\begin{itemize}[nosep]
  \item UC-1 --- Registrazione
  \item UC-2 --- Effettua prestito
  \item UC-5 --- Login
  \item UC-9 --- Verifica disponibilit\`{a} opera
  \item UC-10 --- Recupero ISBN
  \item UC-11 --- Cancella prestito
  \item UC-12 --- Prolunga prestito
\end{itemize}
\end{mdframed}

\subsection{Proposal B --- Compact table (\ok/\nok) + gap summary}
\begin{mdframed}[style=proposalframe]
\section*{Traceability Analysis}

\begin{longtable}{l >{\RaggedRight\arraybackslash}p{5.5cm} c c}
\toprule
\textbf{UC} & \textbf{Name} & \textbf{Design} & \textbf{Test} \\
\midrule
\endhead
UC-1 & Registrazione & \ok & \ok \\
UC-2 & Effettua prestito & \ok & \ok \\
UC-3 & Aggiunge libro & \ok & \nok \\
UC-4 & Conclude Prestito & \ok & \nok \\
UC-5 & Login & \ok & \ok \\
UC-6 & Modifica account & \ok & \nok \\
UC-7 & Elimina account & \ok & \nok \\
UC-8 & Visualizza catalogo & \ok & \nok \\
UC-9 & Verifica disponibilit\`{a} opera & \ok & \ok \\
UC-10 & Recupero ISBN & \ok & \ok \\
UC-11 & Cancella prestito & \ok & \ok \\
UC-12 & Prolunga prestito & \ok & \ok \\
UC-13 & Commento su opera & \ok & \nok \\
UC-14 & Commento su volume & \ok & \nok \\
UC-15 & Visualizza commenti & \ok & \nok \\
UC-16 & Modifica libro & \ok & \nok \\
UC-17 & Rimuove libro & \ok & \nok \\
\bottomrule
\end{longtable}

\medskip
\textbf{Summary:} All 17 use cases have design references. 10 lack test coverage.\\
\textbf{Suggestion:} Prioritize adding tests for UC-3, UC-4 (core operations), then UC-6, UC-7 (account management).
\end{mdframed}

\subsection{Proposal C --- Grouped by gap type}
\begin{mdframed}[style=proposalframe]
\section*{Traceability Analysis}
Of 17 use cases: all have design references, 7 have test coverage.

\subsection*{Missing Test Coverage (10 use cases)}
\begin{longtable}{l >{\RaggedRight\arraybackslash}p{6cm} >{\RaggedRight\arraybackslash}p{5cm}}
\toprule
\textbf{UC} & \textbf{Name} & \textbf{Suggested Test} \\
\midrule
\endhead
UC-3 & Aggiunge libro & Test \texttt{aggiungiLibro()} flow \\
UC-4 & Conclude Prestito & Test loan completion \\
UC-6 & Modifica account & Test profile update \\
UC-7 & Elimina account & Test account deletion \\
UC-8 & Visualizza catalogo & Test catalog browsing \\
UC-13 & Commento su opera & Test comment creation \\
UC-14 & Commento su volume & Test volume comment \\
UC-15 & Visualizza commenti & Test comment listing \\
UC-16 & Modifica libro & Test book editing \\
UC-17 & Rimuove libro & Test book removal \\
\bottomrule
\end{longtable}

\textbf{Suggestion:} Create a traceability matrix and add at least one test per critical UC.

\subsection*{Fully Covered}
{\small UC-1, UC-2, UC-5, UC-9, UC-10, UC-11, UC-12}
\end{mdframed}

\newpage
% ══════════════════════════════════════════════════════════════
\section{Missing Features}
% ══════════════════════════════════════════════════════════════

\subsection{Proposal A --- Description list with Problem/Suggestion}
\begin{mdframed}[style=proposalframe]
\section*{Missing Features}
5 of 7 features are fully present. 2 require attention.

\begin{description}[style=nextline, leftmargin=1em]
  \item[Unit testing framework --- \textsc{partial} (60\%)]
  \textbf{Problem:} Tests hit the real database with no mocking framework. No explicit separation between unit and integration tests. Dependency isolation is missing.

  \textbf{Suggestion:} Introduce Mockito for unit test isolation. Add a brief section distinguishing unit tests (mocked dependencies) from integration tests (real DB).

  \item[Use Case Documentation --- \textsc{partial} (60\%)]
  \textbf{Problem:} Pre-conditions and post-conditions are not specified for any use case. Relationships between use cases (\texttt{<<include>>}) are shown in diagrams but not explained in text.

  \textbf{Suggestion:} Add pre/post-conditions to each UC template. Add a paragraph explaining UC relationships.
\end{description}
\end{mdframed}

\subsection{Proposal B --- Summary table + details below}
\begin{mdframed}[style=proposalframe]
\section*{Missing Features}
\begin{tabular}{>{\RaggedRight\arraybackslash}p{5cm} c c}
\toprule
\textbf{Feature} & \textbf{Status} & \textbf{Coverage} \\
\midrule
Unit testing framework & \textsc{partial} & 60\% \\
Use Case Documentation & \textsc{partial} & 60\% \\
\textit{5 other features} & \textsc{present} & 100\% \\
\bottomrule
\end{tabular}

\medskip
\paragraph{Unit testing:} Tests lack dependency isolation (no mocking). $\rightarrow$ Introduce Mockito and clarify test categories.

\paragraph{Use Cases:} Pre/post-conditions missing from templates. $\rightarrow$ Add conditions and explain \texttt{<<include>>} relationships.
\end{mdframed}

\subsection{Proposal C --- Compact itemize}
\begin{mdframed}[style=proposalframe]
\section*{Missing Features}
5 of 7 expected features are fully present. 2 need improvement:
\begin{itemize}[leftmargin=*]
  \item \textbf{Unit testing framework} (60\%): Tests lack dependency isolation (no mocking). $\rightarrow$ Separate unit from integration tests and introduce Mockito.
  \item \textbf{Use Case Documentation} (60\%): Pre/post-conditions missing. $\rightarrow$ Add them to each UC template for improved traceability.
\end{itemize}
\end{mdframed}

\newpage
% ══════════════════════════════════════════════════════════════
\section{Action Plan}
% ══════════════════════════════════════════════════════════════

\subsection{Proposal A --- Table with priority, effort, impact}
\begin{mdframed}[style=proposalframe]
\section*{Action Plan}
The following actions are recommended in order of priority.

\begin{longtable}{c l >{\RaggedRight\arraybackslash}p{5.5cm} c c}
\toprule
\textbf{\#} & \textbf{Issue} & \textbf{Action} & \textbf{Effort} & \textbf{Impact} \\
\midrule
\endhead
1 & ARCH-001 & Separate UI logic from services & Medium & Medium \\
2 & ARCH-002 & Clarify session management approach & Medium & Medium \\
3 & REQ-002 & Add missing UC templates & Low & Medium \\
4 & TST-001 & Create UC $\rightarrow$ Test traceability & Low & Medium \\
5 & REQ-003 & Reflect max-loan rule in UC-2 & Low & Medium \\
\bottomrule
\end{longtable}

{\small \textbf{Effort:} estimated time to implement the fix. \textbf{Impact:} expected improvement on document quality.}
\end{mdframed}

\subsection{Proposal B --- Numbered list (no table)}
\begin{mdframed}[style=proposalframe]
\section*{Action Plan}
\begin{enumerate}
  \item Separate UI concerns from the service layer (ARCH-001) --- Medium effort, Medium impact
  \item Clarify session management approach (ARCH-002) --- Medium effort, Medium impact
  \item Add templates for missing use cases (REQ-002) --- Low effort, Medium impact
  \item Create UC $\rightarrow$ Test traceability table (TST-001) --- Low effort, Medium impact
  \item Reflect max-loan rule in UC-2 (REQ-003) --- Low effort, Medium impact
\end{enumerate}
\end{mdframed}

\subsection{Proposal C --- Remove action plan entirely}
\begin{mdframed}[style=proposalframe]
\section*{Action Plan}
\textit{[This section would be removed entirely. All suggestions are already provided inline within each section (Architecture, Use Cases, Testing, Traceability). Keeping a separate Action Plan section creates redundancy.]}
\end{mdframed}

\end{document}
